import "hash"

private rule Macho
{
    meta:
        description = "private rule to match Mach-O binaries"
    condition:
        uint32(0) == 0xfeedface or uint32(0) == 0xcefaedfe or uint32(0) == 0xfeedfacf or uint32(0) == 0xcffaedfe or uint32(0) == 0xcafebabe or uint32(0) == 0xbebafeca
}

rule XProtect_OSX_Proton_B
{
    meta:
        description = "OSX.Proton.B"
        
    condition:
        //Macho and filesize < 800000 and hash.sha1(0, filesize) == "a8ea82ee767091098b0e275a80d25d3bc79e0cea"
        Macho and filesize < 800000 and hash.sha1(0, filesize) == "a1d23706522fcc5be456e45a9a64ef6d1275cea1"
}
